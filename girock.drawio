<mxfile host="app.diagrams.net" modified="2021-05-26T09:10:06.955Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36" etag="mWgndKphlFVQlXKE3hij" version="14.6.13" type="github">
  <diagram id="1ifoKKJXksdBjyNbpdKP" name="Page-1">
    <mxGraphModel dx="1722" dy="1695" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-23" value="" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-30" y="280" width="660" height="530" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-1" value="&lt;b&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;girock sdk&lt;/font&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="172.5" y="300" width="147.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-2" value="&lt;span style=&quot;color: rgb(0 , 0 , 0) ; font-family: &amp;#34;helvetica&amp;#34; ; font-size: 12px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: center ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(248 , 249 , 250) ; display: inline ; float: none&quot;&gt;提供简单可复用图形/图像算法调度和服务，作为整体架构后端，用户层无感知&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="170" y="360" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-3" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;单管线算法调度&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="440" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-5" value="&lt;font face=&quot;helvetica&quot;&gt;A方案： 算法实例模块解耦，类比opencv库，不考虑整体算法调度方案，降低使用难度。&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="150" y="410" width="165" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-6" value="&lt;font face=&quot;helvetica&quot;&gt;B方案：类比bach库，提供整体算法调度解决方案。&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="380" y="400" width="165" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-9" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;算法调度&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-20" y="410" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-10" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;云服务&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-20" y="530" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-12" value="&lt;font face=&quot;helvetica&quot;&gt;提供云端算法回调服务，和本地部署解耦，通过lua脚本新增消息机制，为后续新算法提供新消息格式，避免发版和包体积占用。&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="155" y="530" width="205" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-13" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;基础模块&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-20" y="650" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-14" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;图形学&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="150" y="650" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-15" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;CV&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="150" y="750" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-16" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;AR&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="150" y="700" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-18" value="&lt;font face=&quot;helvetica&quot;&gt;1. 已接入形变BBW/MLS&lt;br&gt;2. 提供图形学相关函数&lt;br&gt;&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="315" y="650" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-19" value="&lt;span style=&quot;font-size: 17px&quot;&gt;&lt;b&gt;工具&lt;/b&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="530" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-20" value="&lt;font face=&quot;helvetica&quot;&gt;依托Editor&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="540" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-21" value="&lt;font face=&quot;helvetica&quot;&gt;1. Aruco marker库接入&lt;br&gt;2. ARToolKit markerless库接入&lt;br&gt;&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="315" y="700" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-24" value="" style="shape=flexArrow;endArrow=classic;html=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="270" as="sourcePoint" />
            <mxPoint x="280" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-26" value="&lt;font style=&quot;font-size: 25px&quot;&gt;后端&lt;/font&gt;" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-10" y="305" width="110" height="45" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-27" value="&lt;font style=&quot;font-size: 25px&quot;&gt;Wrapper层&lt;/font&gt;" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="180" y="170" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-28" value="&lt;font style=&quot;font-size: 25px&quot;&gt;Manager&lt;/font&gt;" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="175" y="100" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-29" value="&lt;font style=&quot;font-size: 25px&quot;&gt;Controller&lt;/font&gt;" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="172.5" y="30" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-30" value="&lt;font style=&quot;font-size: 25px&quot;&gt;ECS&lt;/font&gt;" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="172.5" y="-90" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-32" value="EffectManager初始化，作为girock服务管理入口，管理算法工厂函数" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="340" y="30" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-34" value="调度 controller方法，提供算法实例生成，算法对象可由ECS脚本注入" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="330" y="-70" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-35" value="&lt;span style=&quot;font-size: 25px&quot;&gt;网络服务&lt;/span&gt;" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="370" y="170" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-36" value="" style="endArrow=none;html=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="190" as="sourcePoint" />
            <mxPoint x="370" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-37" value="持有算法工厂unique_ptr指针" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="560" y="30" width="175" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-38" value="ECS" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-310" y="-60" width="90" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-40" value="&lt;h1&gt;ECS&lt;/h1&gt;&lt;p&gt;1. 通过BEFContext::instance 获取girock controller&lt;/p&gt;&lt;p&gt;2. 本地开启必要服务&lt;/p&gt;&lt;p&gt;3. 脚本注入开启需要的算法backend和服务，component中管理sessionWrapper用于包裹算法backend或服务，供system调用&lt;/p&gt;&lt;p&gt;4. 算法结果RTTI到lua&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-320" y="10" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-41" value="&lt;h1&gt;Controller&lt;/h1&gt;&lt;p&gt;Effect 和 girock 之间 bridge，作为girock服务管理入口，管理算法backend及服务工厂，持有算法工厂 基类 unique_ptr，外部构造该工厂子类，controller构造时作为参数注入&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-330" y="220" width="210" height="130" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-43" value="&lt;h1&gt;Manager&lt;/h1&gt;&lt;div&gt;BackendManager具体manager子类，继承算法工厂基类，管理不同入口：如算法构建/云服务架构...&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-330" y="350" width="190" height="120" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-44" value="&lt;h1&gt;Wrapper层&lt;/h1&gt;&lt;div&gt;具体算法backend或服务的壳，继承相同基类，controller创建算法backend或服务时，构造wrapper并注入backend或服务指针。统一接口对外壳类，用于system中调用。&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-340" y="480" width="190" height="150" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-46" value="&lt;h1&gt;Backend&lt;/h1&gt;&lt;div&gt;算法或云服务后端，被Manager创建，并通过Wrapper对外封装。&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;用法上任意定制化，但对外壳应该统一 成黑箱？&lt;/div&gt;&lt;div&gt;比如一个形变算法，包含算法构造，参数输入，结果输出；输入和输出，针对不同算法完全不同。&lt;/div&gt;&lt;div&gt;输入需要从算法线程获取，&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-370" y="650" width="190" height="190" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-48" value="&lt;h1&gt;lua&lt;/h1&gt;&lt;div&gt;脚本开启算法或云服务&lt;/div&gt;&lt;div&gt;参数控制是否常开算法&lt;/div&gt;&lt;div&gt;脚本获取算法结果&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;算法无依赖，顺序执行&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="860" width="190" height="190" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-50" value="GiServiceSystem&lt;br&gt;&lt;br&gt;&lt;br&gt;GiServiceComponent" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-630" y="50" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-51" value="girock库接入" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-620" y="120" width="100" height="35" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-52" value="头文件&lt;br&gt;不同的算法类型有不同的接口，没法统一" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-630" y="185" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="UuJ1qdc-aY3ee8Mtvgij-53" value="后端引入算法头文件，针对不同的算法类型接入，这不是和bach重复了？&lt;br&gt;怎么封装 girock？&lt;br&gt;可能还是得手动接入一遍，提供buffer调度机制。&lt;br&gt;接入后如何统一wrapper层接口？" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-660" y="255" width="210" height="120" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
